<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sales Meeting Email Drafter - K-APEX</title>
    <style>
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #f5f5f5 0%, #e0e0e0 100%);
            min-height: 100vh;
            padding: 20px;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
        }
        
        .header {
            background: linear-gradient(135deg, #f37021 0%, #d35400 100%);
            color: white;
            padding: 25px 30px;
            border-radius: 12px 12px 0 0;
            text-align: center;
            box-shadow: 0 4px 15px rgba(243, 112, 33, 0.3);
        }
        
        .header h1 {
            font-size: 1.8rem;
            margin-bottom: 5px;
        }
        
        .header p {
            opacity: 0.9;
            font-size: 0.95rem;
        }
        
        .main-content {
            background: white;
            padding: 30px;
            border-radius: 0 0 12px 12px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.1);
        }
        
        .instructions {
            background: #fff8f0;
            border-left: 4px solid #f37021;
            padding: 15px 20px;
            margin-bottom: 25px;
            border-radius: 0 8px 8px 0;
        }
        
        .instructions h3 {
            color: #f37021;
            margin-bottom: 8px;
        }
        
        .instructions p {
            color: #555;
            line-height: 1.5;
        }
        
        .email-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(350px, 1fr));
            gap: 20px;
            margin-bottom: 25px;
        }
        
        .email-card {
            background: #fafafa;
            border: 1px solid #e0e0e0;
            border-radius: 10px;
            padding: 20px;
            transition: all 0.3s ease;
        }
        
        .email-card:hover {
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            transform: translateY(-2px);
        }
        
        .email-card.sent {
            background: #f0fff0;
            border-color: #4CAF50;
        }
        
        .email-card h3 {
            color: #333;
            font-size: 1.1rem;
            margin-bottom: 12px;
            padding-bottom: 10px;
            border-bottom: 2px solid #f37021;
        }
        
        .email-card .detail {
            margin-bottom: 8px;
            font-size: 0.85rem;
        }
        
        .email-card .detail strong {
            color: #555;
        }
        
        .email-card .recipients {
            color: #666;
            font-size: 0.8rem;
            max-height: 60px;
            overflow-y: auto;
            background: white;
            padding: 8px;
            border-radius: 4px;
            border: 1px solid #eee;
            margin-top: 5px;
            word-break: break-all;
        }
        
        .btn {
            display: inline-block;
            padding: 12px 24px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-size: 0.95rem;
            font-weight: 600;
            transition: all 0.3s ease;
            text-decoration: none;
            text-align: center;
        }
        
        .btn-primary {
            background: linear-gradient(135deg, #f37021 0%, #d35400 100%);
            color: white;
            width: 100%;
            margin-top: 15px;
        }
        
        .btn-primary:hover {
            background: linear-gradient(135deg, #d35400 0%, #b34700 100%);
            transform: scale(1.02);
        }
        
        .btn-primary:disabled {
            background: #ccc;
            cursor: not-allowed;
            transform: none;
        }
        
        .btn-success {
            background: #4CAF50;
            color: white;
        }
        
        .btn-all {
            background: linear-gradient(135deg, #4a4a4a 0%, #333 100%);
            color: white;
            padding: 15px 40px;
            font-size: 1.1rem;
        }
        
        .btn-all:hover {
            background: linear-gradient(135deg, #333 0%, #1a1a1a 100%);
        }
        
        .actions-bar {
            display: flex;
            justify-content: center;
            gap: 15px;
            flex-wrap: wrap;
            padding-top: 20px;
            border-top: 1px solid #eee;
        }
        
        .status-badge {
            display: inline-block;
            padding: 4px 10px;
            border-radius: 12px;
            font-size: 0.75rem;
            font-weight: 600;
            margin-left: 10px;
        }
        
        .status-pending {
            background: #fff3e0;
            color: #f57c00;
        }
        
        .status-opened {
            background: #e8f5e9;
            color: #388e3c;
        }
        
        .counter {
            text-align: center;
            margin-bottom: 20px;
            font-size: 1rem;
            color: #666;
        }
        
        .counter span {
            font-weight: 700;
            color: #f37021;
        }
        
        .preview-section {
            margin-top: 30px;
            padding-top: 25px;
            border-top: 2px solid #eee;
        }
        
        .preview-section h3 {
            color: #333;
            margin-bottom: 15px;
        }
        
        .preview-box {
            background: #f9f9f9;
            border: 1px solid #ddd;
            border-radius: 8px;
            padding: 20px;
            font-family: 'Consolas', 'Courier New', monospace;
            font-size: 0.85rem;
            white-space: pre-wrap;
            line-height: 1.6;
            max-height: 400px;
            overflow-y: auto;
        }
        
        .footer {
            text-align: center;
            margin-top: 20px;
            color: #888;
            font-size: 0.85rem;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üìß Sales Meeting Email Drafter</h1>
            <p>Draft and send reminder emails to all 9 sales groups</p>
        </div>
        
        <div class="main-content">
            <div class="instructions">
                <h3>üìã Instructions</h3>
                <p>Click each button to open a pre-filled email in Outlook. Review the email and click Send. Mark as "Opened" to track your progress. Use "Open All Emails" to draft all 9 at once.</p>
            </div>
            
            <div class="counter">
                Emails Opened: <span id="openedCount">0</span> / <span id="totalCount">9</span>
            </div>
            
            <div class="email-grid" id="emailGrid">
                <!-- Email cards will be generated here -->
            </div>
            
            <div class="actions-bar">
                <button class="btn btn-all" onclick="openAllEmails()">üì® Open All Emails</button>
                <button class="btn btn-all" style="background: linear-gradient(135deg, #607D8B 0%, #455A64 100%);" onclick="resetAll()">üîÑ Reset All</button>
            </div>
            
            <div class="preview-section">
                <h3>üìù Email Body Preview</h3>
                <div class="preview-box" id="previewBox"></div>
            </div>
        </div>
        
        <div class="footer">
            K-APEX (SFO) | Sales Meeting Reminder Tool
        </div>
    </div>

    <script>
        // Email data for all 9 sales groups
        const emailData = [
            {
                group: "SFO Sales Group",
                link: "https://kerryoffice365us-my.sharepoint.com/:p:/g/personal/lvazquez03_kln_com/EayiS3SYa4RLtCRqUJxWJ6oBWs_XxREM3TbPBBvABh8Ayw?e=NsSxy0",
                recipients: ["US.SFO.KApex.Sales@KLN.COM"]
            },
            {
                group: "BUR Sales Group",
                link: "https://kerryoffice365us-my.sharepoint.com/:p:/g/personal/lvazquez03_kln_com/EdtHP_jANaBAmxmuCfPLxCABveS4p6DRe_OZDcBJYQb5VQ?e=QCiI30",
                recipients: ["hadden.ou@kln.com", "heather.lin@kln.com", "Kaden.Kwan@kln.com", "Liana.Tsang@kln.com", "marco.lau@apexshipping.com", "Paul.Lin@kln.com", "Richard.Hu@kln.com"]
            },
            {
                group: "PNW Sales Group",
                link: "https://kerryoffice365us-my.sharepoint.com/:p:/g/personal/lvazquez03_kln_com/Ebs1AwJ7ZA1DhYEH7j9dMQ4BSaPz13Inbkkjo5-8m0Cvjw?e=t2BFIK",
                recipients: ["mike.langley@kln.com", "michelle.mccormick@kln.com", "Jonathan.pan@kln.com", "Doris.Sun@kln.com"]
            },
            {
                group: "ORD Sales Group",
                link: "https://kerryoffice365us-my.sharepoint.com/:p:/g/personal/lvazquez03_kln_com/EU8-aQgLHllKq20Il6LQxh0BM-b9dDE5AuaBSc1grTKUrw?e=fWW64D",
                recipients: ["US.ORD.KApex.Sales@KLN.COM"]
            },
            {
                group: "NYC Sales Group",
                link: "https://kerryoffice365us-my.sharepoint.com/:p:/g/personal/lvazquez03_kln_com/EQeV0n9b2ltFjXoROJ0YkfcBrscMO8_kG0Qt5ZoEfLaqxw?e=B5jD2Z",
                recipients: ["US.NYC.KApex.Sales@KLN.COM"]
            },
            {
                group: "MIA Sales Group",
                link: "https://kerryoffice365us-my.sharepoint.com/:p:/g/personal/lvazquez03_kln_com/ERQh2yfE1vlFo7HIKOVSJx8B0vSnpKXXpI2qA8atsy0KFw?e=zjUUeC",
                recipients: ["Al.Sullivan@kln.com", "Mabel.Rivera@kln.com", "Maria.Pacherres@kln.com", "Rosanna.Leon-Regalado@kln.com"]
            },
            {
                group: "LAX Sales Group",
                link: "https://kerryoffice365us-my.sharepoint.com/:p:/g/personal/lvazquez03_kln_com/EbWYUcivv9hEtXd6e4Iz8-YBTMCeo-scYSwruDd4MeMGXg?e=rTTfmN",
                recipients: ["US.LAX.KApex.Sales@KLN.COM"]
            },
            {
                group: "Air Meeting",
                link: "https://kerryoffice365us-my.sharepoint.com/:p:/g/personal/lvazquez03_kln_com/ERcJ8ynpr4xBq5gEzhU1qPcBHxD8H2QKevjKAo8cDZb4ag?e=V0ZoEZ",
                recipients: ["robert.bleck@kln.com", "steve.yeh@kln.com", "Paul.Lin@kln.com", "hadden.ou@kln.com", "mike.langley@kln.com", "aileen.hsieh@kln.com", "michelle.mccormick@kln.com", "Ellen.Alejo@kln.com", "Armando.Cartaya@kerrylogistics.com", "rick.tong@kln.com", "Christin.Haenig@Kerrylogistics.com", "US.KApex.StarlinkSales@KLN.COM", "Al.Sullivan@kln.com", "henry.chen@kln.com", "Joe.DiDomenico@kln.com", "michael.li@kln.com", "angela.sim@kln.com"]
            },
            {
                group: "GLO Sales Group",
                link: "https://kerryoffice365us-my.sharepoint.com/:p:/g/personal/lvazquez03_kln_com/EXPBmef43idPq_EDX2vrFSwBmQ5Am7Z6WqSDm-t-o_5Mog?e=O721n6",
                recipients: ["Tim.Saling@kln.com", "kurt.mcelroy@kln.com", "thomas.hardy@kln.com", "Joe.aloia@kln.com", "Asif.Mohiuddin@kln.com"]
            }
        ];

        const ccEmail = "Tucson.Avery@kln.com";
        
        // Track opened status
        let openedStatus = {};

        function getEmailBody(link) {
            return `Hello All,

Kind reminder to please update your slides before 3pm PST Thursday so we may compile the slides for Friday morning's meeting.

To prevent cluttered slides, please use below mandatory format and only write a few sentences max for update.

Please do not type out everything you will be saying, we appreciate your input but would like to make the slides look cleaner.

Remember, you can always add details during your designated time to speak.


[Sales Rep Initials]
[Customer Name]
Commodity:
Routing:
Update:

Example:

RH
AMERICAN CASHEW COMPANY LLC
Commodity: Foodstuff
Routing: Vietnam - USWC
Update: Sales lead from Vietnam office,
started initial contact with PIC this week.
Will follow up with PIC next week.

${link}

Please reach out to me if you have any questions.

*Anything submitted after the deadline will not make it onto the PowerPoint*`;
        }

        function createMailtoLink(data) {
            const subject = encodeURIComponent(`Sales Meeting Reminder - ${data.group}`);
            const to = encodeURIComponent(data.recipients.join(';'));
            const cc = encodeURIComponent(ccEmail);
            const body = encodeURIComponent(getEmailBody(data.link));
            
            return `mailto:${to}?cc=${cc}&subject=${subject}&body=${body}`;
        }

        function openEmail(index) {
            const data = emailData[index];
            const mailtoLink = createMailtoLink(data);
            window.open(mailtoLink, '_blank');
            markAsOpened(index);
        }

        function markAsOpened(index) {
            openedStatus[index] = true;
            updateUI();
        }

        function updateUI() {
            const cards = document.querySelectorAll('.email-card');
            let openedCount = 0;
            
            cards.forEach((card, index) => {
                const badge = card.querySelector('.status-badge');
                const btn = card.querySelector('.btn-primary');
                
                if (openedStatus[index]) {
                    card.classList.add('sent');
                    badge.textContent = '‚úì Opened';
                    badge.className = 'status-badge status-opened';
                    btn.textContent = 'üìß Open Again';
                    openedCount++;
                } else {
                    card.classList.remove('sent');
                    badge.textContent = 'Pending';
                    badge.className = 'status-badge status-pending';
                    btn.textContent = 'üìß Open in Outlook';
                }
            });
            
            document.getElementById('openedCount').textContent = openedCount;
        }

        function openAllEmails() {
            if (confirm('This will open 9 email drafts in Outlook. Continue?')) {
                emailData.forEach((_, index) => {
                    setTimeout(() => {
                        openEmail(index);
                    }, index * 500); // Stagger by 500ms to prevent browser blocking
                });
            }
        }

        function resetAll() {
            openedStatus = {};
            updateUI();
        }

        function renderEmailCards() {
            const grid = document.getElementById('emailGrid');
            
            emailData.forEach((data, index) => {
                const card = document.createElement('div');
                card.className = 'email-card';
                card.innerHTML = `
                    <h3>${data.group} <span class="status-badge status-pending">Pending</span></h3>
                    <div class="detail"><strong>Subject:</strong> Sales Meeting Reminder - ${data.group}</div>
                    <div class="detail"><strong>To:</strong> (${data.recipients.length} recipient${data.recipients.length > 1 ? 's' : ''})
                        <div class="recipients">${data.recipients.join('; ')}</div>
                    </div>
                    <div class="detail"><strong>CC:</strong> ${ccEmail}</div>
                    <button class="btn btn-primary" onclick="openEmail(${index})">üìß Open in Outlook</button>
                `;
                grid.appendChild(card);
            });
        }

        function renderPreview() {
            const preview = document.getElementById('previewBox');
            preview.textContent = getEmailBody('[UNIQUE SHAREPOINT LINK]');
        }

        // Initialize
        renderEmailCards();
        renderPreview();
        document.getElementById('totalCount').textContent = emailData.length;
    </script>
</body>
</html>
